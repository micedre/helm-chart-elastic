# Default values for elasticsearch chart

# Elasticsearch configuration
elasticsearch:
  # Enable cluster mode (true) or single-node mode (false)
  clusterMode: true

  # Number of Elasticsearch replicas
  # For single-node: set to 1
  # For cluster: recommended 3+ for HA
  replicas: 3

  # Docker image configuration
  image:
    repository: docker.elastic.co/elasticsearch/elasticsearch
    tag: "9.2.3"
    pullPolicy: IfNotPresent
    # Custom image override (for advanced use cases)
    custom:
      enabled: false
      repository: docker.elastic.co/elasticsearch/elasticsearch
      tag: "9.2.3"

  # Service account
  serviceAccount:
    create: true
    name: ""
    annotations: {}

  # Resource requests and limits
  resources:
    requests:
      cpu: "1000m"
      memory: "2Gi"
    limits:
      cpu: "2000m"
      memory: "4Gi"

  # JVM heap size (should be ~50% of memory limit)
  javaOpts: "-Xms1g -Xmx1g"

  # Persistent storage configuration
  persistence:
    enabled: true
    storageClass: ""  # Leave empty for default storage class
    accessMode: ReadWriteOnce
    size: 30Gi

  # Security configuration
  security:
    enabled: true
    # TLS configuration
    tls:
      enabled: true
      # Set to true to use your own certificates
      # Otherwise, self-signed certificates will be generated
      useSelfSignedCerts: true
      # Use existing secret for certificates (optional)
      # If set, certificates won't be auto-generated
      certificatesSecret: ""
    # Elasticsearch password (auto-generated if not set)
    password: ""

  # Service configuration
  service:
    type: ClusterIP
    httpPort: 9200
    transportPort: 9300
    annotations: {}

  # Ingress configuration (optional)
  ingress:
    enabled: false
    className: ""
    annotations: {}
    hosts:
      - host: elasticsearch.local
        paths:
          - path: /
            pathType: Prefix
    tls: []

  # Pod annotations
  podAnnotations: {}

  # Pod security context
  podSecurityContext:
    fsGroup: 1000
    runAsUser: 1000

  # Container security context
  securityContext:
    capabilities:
      drop:
        - ALL
    readOnlyRootFilesystem: false
    runAsNonRoot: true
    runAsUser: 1000

  # Node selector
  nodeSelector: {}

  # Tolerations
  tolerations: []

  # Affinity and anti-affinity rules
  affinity:
    # Enable pod anti-affinity for HA (distributes pods across nodes)
    podAntiAffinity: soft

  # Topology spread constraints for better pod distribution across zones
  topologySpreadConstraints: []
    # Example for multi-zone distribution:
    # - maxSkew: 1
    #   topologyKey: topology.kubernetes.io/zone
    #   whenUnsatisfiable: DoNotSchedule
    #   labelSelector:
    #     matchLabels:
    #       app.kubernetes.io/component: elasticsearch

  # Additional environment variables
  extraEnvVars: []

  # Additional volumes
  extraVolumes: []

  # Additional volume mounts
  extraVolumeMounts: []

  # Custom elasticsearch.yml configuration
  # Will be merged with default configuration
  config: {}
    # Example:
    # node.roles: [ master, data, ingest ]
    # indices.memory.index_buffer_size: 30%

  # Elasticsearch plugins to install
  plugins: []
    # Example:
    # - repository-s3
    # - analysis-icu

  # PodDisruptionBudget configuration
  pdb:
    enabled: true
    # Minimum number of pods that must be available
    # Can be an integer or percentage (e.g., "50%")
    minAvailable: ""
    # Maximum number of pods that can be unavailable
    # Alternative to minAvailable (only set one)
    maxUnavailable: 1

  # StatefulSet update strategy
  updateStrategy:
    type: RollingUpdate
    rollingUpdate:
      # Partition allows for canary deployments
      partition: 0

  # Graceful termination period (seconds)
  terminationGracePeriodSeconds: 120

  # Lifecycle hooks for graceful shutdown
  lifecycle:
    preStop:
      enabled: true
      # Custom preStop command (optional)
      # If not set, default graceful shutdown command will be used
      command: []

  # Liveness probe configuration
  livenessProbe:
    enabled: true
    initialDelaySeconds: 90
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
    successThreshold: 1

  # Readiness probe configuration
  readinessProbe:
    enabled: true
    initialDelaySeconds: 60
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
    successThreshold: 1

  # Init containers configuration
  initContainers:
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 256Mi

# Kibana configuration
kibana:
  # Enable or disable Kibana deployment
  enabled: true

  # Number of Kibana replicas
  replicas: 1

  # Docker image configuration
  image:
    repository: docker.elastic.co/kibana/kibana
    tag: "9.2.3"
    pullPolicy: IfNotPresent
    # Custom image override (for advanced use cases)
    custom:
      enabled: false
      repository: docker.elastic.co/kibana/kibana
      tag: "9.2.3"

  # Resource requests and limits
  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "1000m"
      memory: "2Gi"

  # Service configuration
  service:
    type: ClusterIP
    port: 5601
    annotations: {}

  # Ingress configuration (optional)
  ingress:
    enabled: false
    className: ""
    annotations: {}
    hosts:
      - host: kibana.local
        paths:
          - path: /
            pathType: Prefix
    tls: []

  # Pod annotations
  podAnnotations: {}

  # Pod security context
  podSecurityContext:
    fsGroup: 1000
    runAsUser: 1000

  # Container security context
  securityContext:
    capabilities:
      drop:
        - ALL
    readOnlyRootFilesystem: false
    runAsNonRoot: true
    runAsUser: 1000

  # Node selector
  nodeSelector: {}

  # Tolerations
  tolerations: []

  # Affinity rules
  affinity: {}

  # Additional environment variables
  extraEnvVars: []

  # Custom kibana.yml configuration
  config: {}
    # Example:
    # server.publicBaseUrl: "https://kibana.example.com"
    # logging.quiet: true

  # PodDisruptionBudget configuration
  pdb:
    enabled: true
    minAvailable: ""
    maxUnavailable: 1

  # Liveness probe configuration
  livenessProbe:
    enabled: true
    initialDelaySeconds: 120
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
    successThreshold: 1

  # Readiness probe configuration
  readinessProbe:
    enabled: true
    initialDelaySeconds: 60
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
    successThreshold: 1

  # Init containers configuration
  initContainers:
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 256Mi

# NetworkPolicy configuration
networkPolicy:
  # Enable network policies
  enabled: false
  # Allow external access to services
  allowExternal: true
  # Allow traffic from specific namespaces
  ingressNSMatchLabels: {}
  # Allow traffic from specific pods in those namespaces
  ingressNSPodMatchLabels: {}

# Prometheus metrics configuration
metrics:
  enabled: false
  serviceMonitor:
    # Enable ServiceMonitor for Prometheus Operator
    enabled: false
    # Namespace to deploy ServiceMonitor (defaults to release namespace)
    namespace: ""
    # Scrape interval
    interval: 30s
    # Scrape timeout
    scrapeTimeout: 10s
    # Additional labels for ServiceMonitor
    labels: {}
    # Relabelings
    relabelings: []
    # Metric relabelings
    metricRelabelings: []

# Common labels to apply to all resources
commonLabels: {}

# Common annotations to apply to all resources
commonAnnotations: {}
